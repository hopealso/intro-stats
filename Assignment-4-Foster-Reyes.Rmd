---
title: "Introduction to Statistical Concepts, MSCA 31000, Assignment 4"
author: "Hope Foster-Reyes"
date: "March 26, 2016"
output: pdf_document
header-includes: \usepackage{amsmath}
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#library(reshape2)
#library(ggplot2)
```

## Chapter 14, Q2.

```{r q2}
y.predicted <- function (x, b, a) {
  return((b * x) + a)
}

x.predictor <- function (y, b, a) {
  return((y - a) / b)
}

q2.a <- y.predicted(6, 2, 9)

q2.b <- x.predictor(14, 2, 9)
```

$\hat{y} = bx + a$

$\hat{y} = 2x + 9$

### a.

$x = 6$

$\hat{y} = 2x + 9$

$\hat{y} = (2)6 + 9 = `r q2.a`$

### b.

$\hat{y} = 14$

$\hat{y} = 2x + 9$

$2x = \hat{y} - 9$

$x = (14-9)/2 = `r q2.b`$

## Chapter 14, Q4.

The standard error of the estimate measures the accuracy of predictions of a linear regression. It is the standard deviation of the errors of prediction.

If:

$x$ = criterion variable

$y$ = predictor variable (actual)

$\hat{y}$ = predicted value

$N$ = size of the population

Then the standard error of the estimate (SEE) for a population can be calculated as follows:

SEE (population) = $\sqrt{\frac{\sum {(y - \hat{y})}^2}{N}}$

## Chapter 14, Q6.

## Chapter 14, Q8.

## Chapter 14, Q10.

```{r}
x.pre <- c(59,52,44,51,42,42,41,45,27,63,54,44,50,47,55,49,45,57,46,60,65,64,50,74,59)
y.post <- c(56,63,55,50,66,48,58,36,13,50,81,56,64,50,63,57,73,63,46,60,47,73,58,85,44)

cor.prepost <- cor(x.pre, y.post, method = "pearson")
b.post <- cor.prepost * (sd(y.post) / sd(x.pre))
a.post <- mean(y.post) - b.post * mean(x.pre)

post.regression <- data.frame(seq(1, length(x.pre)), x.pre, y.post, 
                              b.post * x.pre + a.post)
colnames(post.regression) <- c("id", "pre", "post", "predicted")

q10 <- y.predicted(43, a = a.post, b = b.post)
```

$\hat{y} = bx + a$

$x = 43$

$\hat{y} = (`r b.post`)43 + `r a.post`$

$\hat{y} = `r q10`$

Plot regression, calculated manually:

```{r}
plot(post.regression$pre, post.regression$post, col = "blue", main = "Manual Linear Regression")
points(post.regression$pre, post.regression$predicted, col = "red")

# Check result using lm()
post.lm <- lm(post ~ pre, data = post.regression)
post.coeffs <- coefficients(post.lm)
q10.test <- y.predicted(43, post.coeffs[2], post.coeffs[1])
```

## Chapter 14, Q12.

$\bar{x} = 10$

$\bar{y} = 12$

$\sigma_{x} = 2.5$

## Prepare Environment

Load libraries.

```{r libraries}
library(xlsx)
library(MKmisc)
```

Download data from online Url to subdirectory local to this RStudio project.

```{r download-data}
if (!file.exists("data")) {
  dir.create("data")
}

# !!!This version of file via automated download fails. 
# Remainder of code for assigment assumes manually imported version of .xlsx file located 
# in data subdirectory of working (.rproj) directory
am.url <- "http://onlinestatbook.com/2/case_studies/data/angry_moods.xls"
am.file <- "./data/angry_moods.xls"
if (!file.exists(am.file)) {
  download.file(am.url, destfile = am.file)
}
```

Import data.

```{r import-data}
am.df <- read.xlsx(am.file, 
                   sheetName = "angry_moods.txt", 
                   header = TRUE,
                   colClasses = rep("integer", 7))
```






