---
title: "Introduction to Statistical Concepts, MSCA 31000, Assignment 3b"
author: "Hope Foster-Reyes"
date: "March 10, 2016"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Prepare Environment

Load libraries.

```{r libraries}
library(xlsx)
library(MKmisc)
```


Download data from online Url to subdirectory local to this RStudio project.

```{r download-data}
if (!file.exists("data")) {
  dir.create("data")
}

# !!!This version of file via automated download fails. 
# Remainder of code for assigment assumes manually imported version of .xlsx file located 
# in data subdirectory of working (.rproj) directory
am.url <- "http://onlinestatbook.com/2/case_studies/data/angry_moods.xls"
am.file <- "./data/angry_moods.xls"
if (!file.exists(am.file)) {
  download.file(am.url, destfile = am.file)
}
```

Import data.

```{r import-data}
am.df <- read.xlsx(am.file, 
                   sheetName = "angry_moods.txt", 
                   header = TRUE,
                   colClasses = rep("integer", 7))
```

## Chapter 10, Q24.

```{r}
male.sample.size <- sum(am.df$Gender == 1)
female.sample.size <- sum(am.df$Gender == 2)

male.sample.mean <- mean(am.df$Anger.Out[am.df$Gender == 1])
female.sample.mean <- mean(am.df$Anger.Out[am.df$Gender == 2])

male.sample.variance <- var(am.df$Anger.Out[am.df$Gender == 1])
female.sample.variance <- var(am.df$Anger.Out[am.df$Gender == 2])

male.sampling.estvariance <- male.sample.variance / male.sample.size
female.sampling.estvariance <- female.sample.variance / female.sample.size
mf.sampling.diff.estvariance <- male.sampling.estvariance + female.sampling.estvariance
mf.sampling.diff.estse <- sqrt(mf.sampling.diff.estvariance)
```

99% Confidence Interval on the difference between gender means:

### 1. First, estimate the standard error of the difference between means:

Because these samples do *not* have the same sample size, rather than use the **MSE** we will estimate the standard error of the difference in means using the **variance sum law**:

$s_{\bar{x}_{AOm} - \bar{x}_{AOf}}^2 = s_{\bar{x}_{AOm}}^2 + s_{\bar{x}_{AOf}}^2$

$s_{\bar{x}_{AOm}}^2 = \frac{s_{AOm}^2}{n_{AOm}}$ = `r male.sampling.estvariance`

$s_{\bar{x}_{AOf}}^2 = \frac{s_{AOf}^2}{n_{AOf}}$ = `r female.sampling.estvariance`

$s_{\bar{x}_{AOm} - \bar{x}_{AOf}} = \sqrt{`r male.sampling.estvariance` + `r female.sampling.estvariance`}$

$s_{\bar{x}_{AOm} - \bar{x}_{AOf}} =$ `r mf.sampling.diff.estse`

### 2. Next, find t critical value:

```{r}
df <- (male.sample.size - 1) + (female.sample.size - 1)

```

df = $(n_{AOm} - 1) + (n_{AOf} - 1)$ = (`r male.sample.size` - 1) + (`r female.sample.size` - 1) = `r df`


